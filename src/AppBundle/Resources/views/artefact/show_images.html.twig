{% set cols = 3 %}
    {% set colspan = 'col-sm-' ~ (12 // cols) %}
    {% set rows = (artefact.images|length / cols)|round(0, 'ceil') %}

    {% for row in 0 .. (rows - 1) %}
        <div class="row">
            {% for col in 0 .. (cols - 1) %}
                {% set index = row * cols + col %}
                {% if artefact.images[index] is defined %}
                    {% set image = artefact.images[index] %}
                    <div class="col-xs-12 {{ colspan }}">
                        <div class="thumbnail">
                            {% if is_granted('ROLE_CONTENT_ADMIN') %}
                                <div class="btn-toolbar">
                                    <div class="btn-group pull-right">
                                        <a href="{{ path('artefact_edit_image', {'id': artefact.id, 'image_id': image.id}) }}" class="btn btn-default">
                                            <span class='glyphicon glyphicon-edit'></span> </a>
                                        <a href="{{ path('artefact_remove_image', {'id': artefact.id, 'image_id': image.id}) }}" class="btn btn-default" data-confirm="Are you sure you want to delete this image?">
                                            <span class='glyphicon glyphicon-remove'></span> </a>
                                    </div>
                                </div>
                            {% endif %}
                            <div class="img-container">
                                <a href="#imgModal" data-toggle="modal" data-title="{$title}" data-date="{$date}" data-target="#imgModal" data-img="{{ asset(image_prefix ~ '/' ~ image.imageFilePath) }}">
                                    <img src="{{ asset(image_prefix ~ '/' ~ image.thumbnailPath) }}" class="img-thumbnail" />
                                </a>
                            </div>
                            <div class="caption">
                                <div class='title'>
                                    {{ image.originalName }}
                                </div>
                                {{ image.description|raw }}
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% endfor %}
        </div>
    {% endfor %}
<div class="modal fade" id="imgModal" tabindex="-1" role="dialog" aria-labelledby="modalTitle">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="glyphicon glyphicon-remove" />
                </button>
                <h4 class="modal-title" id="modalTitle" />
            </div>
            <div class="modal-body">
                <figure>
                    <img src="" id="modalImage" />
                    <figcaption></figcaption>
                </figure>
            </div>
        </div>
    </div>
</div>
